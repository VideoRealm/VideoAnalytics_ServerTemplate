# VideoAnalytics_ServerTemplate
Analytics-running server template code for a [ultimately censored] app - just another bit of trash on Github      

### Шаблон ПО обработки и анализа видеопотока (контроллера сервера аналитики) 
### Функции
1.	Получение и аналитическая обработка потоков с камер путём выполнения специализированных аналитических алгоритмов;
2.	Извлечение и сохранение в БД метаданных, связанных с входными потоками; 
3.	Формирование и сохранение в БД записей, фиксирующих значимые события в потоке данных, поступающих с камер;
4.	Выдача потока в реальном времени по запросу медиасервера (с достижением  чёткости видеоизображения, установленной конкретным пользователем в рамках набора доступных опций).

#### Компоненты ПО в структуре интерфейсов прямого взаимодействия:
- медиасервер;
- видеокамера;
- БД записей (с видеокамер).

Рис. 1. Схема генерации и передачи видеопотока в реальном времени (live stream).
![livestream-Page-1](https://user-images.githubusercontent.com/55311053/80383614-19f93d00-88a4-11ea-9b00-16620c020dd8.jpg)

<em>Пояснения к визуализации</em>
1.	Пользователь выбирает интересующую (предварительно добавленную в персональный или сформированный по умолчанию список) камеру и запрашивает показ видео нажатием специальной кнопки на панели управления;
2.	HTTP-запрос GET передаётся на медиасервер и принимается к выполнению;
3.	Медиасервер направляет запрос на сервер диспетчеризации для получения информации о сервере обработки, на который ранее был переведён поток, переданный с выбранной пользователем камеры;
4.	Медиасервер, используя информацию от диспетчера, обращается к назначенному серверу обработки с запросом на выдачу потока;
5.	Назначенный сервер использует информацию о сетевом адресе камеры (с подключением по протоколу IP) и напрямую запрашивает передачу данных с устройства;
6.	Камера определяет наличие запроса и направляет первичный поток на сервер обработки;
7.	Сервер обработки ретранслирует первичный или подвергнутый аналитической оценке содержимого (т.е. поддерживающий отображение визуальных атрибутов анализа) поток на медиасервер; 
8.	Медиасервер преобразует исходный протокол передачи (RTSP), устанавливает соответствие размеру области отображения в браузере и направляет поток на терминал пользователя в рамках обмена видеоданными по протоколу HLS;
9.	Полученный видеопоток воспроизводится в диалоговом окне клиентского приложения (с поддержкой индивидуального выбора параметров качества воспроизведения).  
  
Рис. 2. Схема определения базовых классов (not match, but tribute to UML class diagram).
Рис. 3. Схема определения программных интерфейсов.
![controller_db](https://user-images.githubusercontent.com/55311053/80387445-f1277680-88a8-11ea-8e96-ada1f01def62.jpg)

Таблица 1. Состав и назначение функций API контроллера.
| Функция | Назначение|
|---|---|
